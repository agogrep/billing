<?xml version="1.0"?>
<script>

    <masterfield>sid</masterfield>

    <part>
      <name>main</name>
      <section>
        <parentselector>.//*[@id="main"]</parentselector>
        <selector>.//*[@id="form"]</selector>
        <repeat>0</repeat>
      </section>
      <sql>
        <readquery>SELECT  s.sid, s.sname, s.sfullname, s.inn, s.stype, s.regnum, s.regdate, s.taxation, s.admin,
          if(s.sgid=0,'',s.sgid) sgid,
          IFNULL(g.sgname,'') sgname,
          s.contacts,
          IF(s.currcid=0,'',s.currcid) currcid,
          s.descr,
          IF(c.cdate=0,'',c.cdate) cdate
          FROM subjects s
          LEFT OUTER JOIN contracts c ON c.cid = s.currcid
          LEFT OUTER JOIN subgroups g ON g.sgid = s.sgid
          WHERE sid = {sid}
        </readquery>
        <writequery>
        </writequery>
        <writegenerator>
          <scriptname>write</scriptname>
          <param>
            <table>subjects</table>
            <id_name>sid</id_name>
          </param>
        </writegenerator>
        <argument>
          <sid><type>int</type><long></long><default></default></sid>
          <sname><type>str</type><long></long><default></default></sname>
          <sfullname><type>str</type><long></long><default></default></sfullname>
          <inn><type>int</type><long></long><default></default></inn>
          <stype><type>str</type><long></long><default>IE</default></stype>
          <regnum><type>int</type><long></long><default></default></regnum>
          <regdate><type>str</type><long></long><default></default></regdate>
          <taxation><type>str</type><long></long><default></default></taxation>
          <admin><type>str</type><long></long><default></default></admin>
          <sgid><type>int</type><long></long><default></default></sgid>
          <contacts><type>str</type><long></long><default></default></contacts>
          <currcid><type>int</type><long></long><default></default></currcid>
          <descr><type>str</type><long></long><default></default></descr>
        </argument>
      </sql>
      <layout>
        <element>
          <selector>.//*[@name="sid"]</selector>
          <attribute></attribute>
          <fild>sid</fild>
        </element>
        <element>
          <selector>.//*[@name="sname"]</selector>
          <attribute>value</attribute>
          <fild>sname</fild>
        </element>
        <element>
          <selector>.//*[@name="sfullname"]</selector>
          <attribute>value</attribute>
          <fild>sfullname</fild>
        </element>
        <element>
          <selector>.//*[@name="inn"]</selector>
          <attribute>value</attribute>
          <fild>inn</fild>
        </element>
        <element>
          <selector>.//*[@name="stype"]</selector>
          <attribute>value</attribute>
          <fild>stype</fild>
        </element>
        <element>
          <selector>.//*[@name="regnum"]</selector>
          <attribute>value</attribute>
          <fild>regnum</fild>
        </element>
        <element>
          <selector>.//*[@name="regdate"]</selector>
          <attribute>value</attribute>
          <fild>regdate</fild>
        </element>
        <element>
          <selector>.//*[@name="taxation"]</selector>
          <attribute></attribute>
          <fild>taxation</fild>
        </element>
        <element>
          <selector>.//*[@name="admin"]</selector>
          <attribute>value</attribute>
          <fild>admin</fild>
        </element>
        <element>
          <selector>.//*[@name="contacts"]</selector>
          <attribute></attribute>
          <fild>contacts</fild>
        </element>
        <element>
          <selector>.//*[@name="currcid"]</selector>
          <attribute></attribute>
          <fild>currcid</fild>
        </element>
        <element>
          <selector>.//*[@name="currcid"]</selector>
          <attribute>data-href</attribute>
          <fild>currcid</fild>
        </element>
        <element>
          <selector>.//*[@name="cdate"]</selector>
          <attribute></attribute>
          <fild>cdate</fild>
        </element>
        <element>
          <selector>.//*[@name="sgid"]</selector>
          <attribute></attribute>
          <fild>sgid</fild>
        </element>
        <element>
          <selector>.//*[@name="sgid"]</selector>
          <attribute>data-href</attribute>
          <fild>sgid</fild>
        </element>
        <element>
          <selector>.//*[@name="sgname"]</selector>
          <attribute></attribute>
          <fild>sgname</fild>
        </element>
        <element>
          <selector>.//*[@name="descr"]</selector>
          <attribute>value</attribute>
          <fild>descr</fild>
        </element>
      </layout>
    </part>

    <part>
      <name>sublabels</name>
      <section>
        <parentselector>.//*[@id="sublabels"]</parentselector>
        <selector>.//*[@name="row"]</selector>
        <repeat>0</repeat>
      </section>
      <sql>
        <readquery>
          SELECT l.ssid ssid, s.slid slid, s.slname slname, l.def def
                FROM sublabels s, slid_sid l
                WHERE l.sid = {sid} AND l.slid = s.slid
        </readquery>
        <writequery>
        </writequery>
        <writegenerator>
          <scriptname>write</scriptname>
          <param>
            <table>slid_sid</table>
            <id_name>ssid</id_name>
          </param>
        </writegenerator>
        <argument>
          <ssid><type>int</type><long></long><default></default></ssid>
          <slid><type>int</type><long></long><default></default></slid>
          <slname><type>str</type><long></long><default></default></slname>
          <def><type>str</type><long></long><default></default></def>
        </argument>
      </sql>
      <layout>
        <element>
          <selector>.//*[@name="ssid"]</selector>
          <attribute></attribute>
          <fild>ssid</fild>
        </element>
        <element>
          <selector>.//*[@name="slid"]</selector>
          <attribute></attribute>
          <fild>slid</fild>
        </element>
        <element>
          <selector>.//*[@name="slid"]</selector>
          <attribute>data-href</attribute>
          <fild>slid</fild>
        </element>
        <element>
          <selector>.//*[@name="slname"]</selector>
          <attribute></attribute>
          <fild>slname</fild>
        </element>
        <element>
          <selector>.//*[@name="def"]</selector>
          <attribute></attribute>
          <fild>def</fild>
        </element>
      </layout>
    </part>
  </script>
